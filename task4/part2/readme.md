# Завдання 2 до теми №4 "Режими роботи шифрів та особливості реалізації"

Для виконання завдання було підготовлено файл з кодом на мові програмування Python 3, з методами check_admin та get_cookie, що реалізують роботу з відповідними API-ендпоінтами Cryptohack. 

Оскільки нам відомий відкритий текст першого блоку (він константний за умовою) та відповідний йому шифротекст, можемо провести криптоаналіз на основі пар відкритого-шифрованого тексту.

Потрібно фактично підмінити перший блок відкритого тексту на власний. Оскільки шифрування не аутентифіковане, це можна легко зробити, банально підмінивши IV на такий, що після XOR з проміжним розшифрованим текстом давав би потрібний нам розшифрований текст.
Згенероване кукі виглядало таким чином:

``
9554db47ed8263270c952bc8043967ad2779375700aaca10aab8e54aefef44b1332f5aaa9fb906c8f57a0adda8678372
``

де `` 9554db47ed8263270c952bc8043967ad `` - це IV, а `` 2779375700aaca10aab8e54aefef44b1332f5aaa9fb906c8f57a0adda8678372 `` - безпосередньо шифротекст.

Ми можемо легко обчислити яке значення подавалось на вхід криптопримітиву шифрування AES, як:
```
IV: "9554db47ed8263270c952bc8043967ad"
 XOR
PT: "61646d696e3d46616c73653b65787069" // hex("admin=False;expi")
 RESULT
    "f430b62e83bf254660e64ef3614117c4"
```

На основі цього, легко порахувати новий IV, який при розшифруванні давав би рядок `` admin=True;;expi ``, замість `` admin=False;expi `` (в даному випадку "пощастило" що нове потрібне значення менше за старе, тому ми просто можемо підігнати його до потрібної довжини зайвими ``;``). Виконаємо зворотний обрахунок:

```
    PT: "61646d696e3d547275653b3b65787069" // hex("admin=True;;expi")
     XOR
    RESULT
        "f430b62e83bf254660e64ef3614117c4"
NEW IV: "9554db47ed827134158375c8043967ad"
```

Далі просто відправляємо серверу оригінальний шифротекст із новим вектором. При розшифруванні він неправильно розшифровує перший блок і опрацьовує підсунуте нами значення.

Фінальний код програми наведено у файлі [task4_2_flipping_cookie.py](task4_2_flipping_cookie.py)

## Результат
Відповідь сервера:

`` 
    {'flag': 'crypto{4u7h3n71c4710n_15_3553n714l}'}
``
